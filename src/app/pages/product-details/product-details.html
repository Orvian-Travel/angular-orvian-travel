<app-header></app-header>
<main class="pacote-main container">
  <h1 class="mb-4">{{ package?.title }}</h1>
  <section class="pacote-layout">
    <div class="imagem-principal">
      <!-- Galeria Swiper com as mídias do pacote -->
      <app-swiper-gallery
        [medias]="package?.medias || []"
        [packageTitle]="package?.title || ''"
      ></app-swiper-gallery>
    </div>
    <aside class="sidebar-pacote">
      <div class="mapa-interativo mb-3">
        <iframe
          src="https://www.openstreetmap.org/export/embed.html?bbox=-43.209%2C-22.908%2C-43.209%2C-22.908&amp;layer=mapnik"
          class="w-100 h-100 border-0 rounded"
          allowfullscreen
          loading="lazy"
        ></iframe>
      </div>
      <div class="dates-section">
        <h4 class="dates-title">Check-in & Check-out</h4>
        <div class="date-inputs">
          <div>
            <mat-form-field class="w-100" appearance="outline">
              <mat-label>Data de partida</mat-label>
              <input
                matInput
                [matDatepicker]="startPicker"
                [matDatepickerFilter]="dateFilter"
                [(ngModel)]="selectedDate"
                (dateChange)="onDateSelected($event.value)"
                readonly
                placeholder="Selecione uma data disponível"
                required
              />
              <mat-datepicker-toggle
                matIconSuffix
                [for]="startPicker"
              ></mat-datepicker-toggle>
              <mat-datepicker
                [dateClass]="dateClass"
                #startPicker
              ></mat-datepicker>
            </mat-form-field>
          </div>
          <div>
            <mat-form-field class="w-100" appearance="outline">
              <mat-label>Data de retorno</mat-label>
              <input
                matInput
                [value]="endDate | date : 'dd/MM/yyyy'"
                readonly
                disabled
                placeholder="Será preenchido automaticamente"
              />
              <mat-icon matIconSuffix>calendar_today</mat-icon>
            </mat-form-field>
          </div>
        </div>
      </div>
      <div class="preco-destaque mb-4">
        <span class="text-muted">Preço por pessoa</span>
        <h2 class="fw-bold text-dark">
          R$ {{ package?.price | number : "1.2-2" : "pt-BR" }}
        </h2>
      </div>
      <p>{{ package?.description }}</p>
      <button
        type="submit"
        class="botao-reserva btn btn-primary btn-lg w-100 mb-3"
        (click)="isLoggedIn ? paymentRedirect() : loginRedirectWithReturn()"
      >
        {{ isLoggedIn ? "Reservar" : "Faça login para reservar" }}
      </button>
    </aside>
  </section>
</main>
<app-card-list></app-card-list>
<app-footer></app-footer>
