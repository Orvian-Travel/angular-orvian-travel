<!-- Seção de Avaliações dos Clientes -->
<section class="ratings-section">
  <div class="container">
    <div class="section-header">
      <h2 class="section-title">O que nossos clientes dizem</h2>
      <p class="section-subtitle">Experiências reais de quem já viajou conosco</p>
    </div>

    <!-- Loading State -->
    <div *ngIf="isLoading" class="loading-container">
      <div class="loading-spinner"></div>
      <p>Carregando avaliações...</p>
    </div>

    <!-- Error State -->
    <div *ngIf="error && !isLoading" class="error-container">
      <p class="error-message">{{ error }}</p>
      <button (click)="loadTopRatings()" class="retry-button">Tentar novamente</button>
    </div>

    <!-- Carrossel de Ratings -->
    <div *ngIf="!isLoading && !error && ratings.length > 0" class="carousel-container">
      <div class="carousel-wrapper">
        <!-- Botão Anterior -->
        <button 
          class="carousel-nav prev" 
          (click)="previousSlide()"
          [disabled]="ratings.length <= 1">
          <svg width="24" height="24" viewBox="0 0 24 24" fill="none">
            <path d="M15 18L9 12L15 6" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
          </svg>
        </button>

        <!-- Slides -->
        <div class="carousel-track">
          <div 
            class="rating-card"
            *ngFor="let rating of ratings; let i = index"
            [class.active]="i === currentSlide"
            [style.transform]="'translateX(' + ((i - currentSlide) * 100) + '%)'">
            
            <!-- Estrelas -->
            <div class="rating-stars">
              <span 
                *ngFor="let filled of getStarsArray(rating.rate)"
                class="star"
                [class.filled]="filled">
                ★
              </span>
            </div>

            <!-- Comentário -->
            <p class="rating-comment">
              "{{ truncateComment(rating.comment) }}"
            </p>

            <!-- Nome do Pacote -->
            <div class="rating-package" *ngIf="rating.packageName">
              <svg width="16" height="16" viewBox="0 0 24 24" fill="none">
                <path d="M21 10c0 7-9 13-9 13s-9-6-9-13a9 9 0 0 1 18 0z" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                <circle cx="12" cy="10" r="3" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
              </svg>
              {{ rating.packageName }}
            </div>

            <!-- Informações do Cliente -->
            <div class="rating-info">
              <div class="rating-author" *ngIf="rating.userName">
                {{ rating.userName }}
              </div>
              <div class="rating-date">
                {{ formatDate(rating.createdAt) }}
              </div>
              <div class="rating-score" (click)="debugRating(rating)">
                {{ rating.rate }}/5
              </div>
            </div>
          </div>
        </div>

        <!-- Botão Próximo -->
        <button 
          class="carousel-nav next" 
          (click)="nextSlide()"
          [disabled]="ratings.length <= 1">
          <svg width="24" height="24" viewBox="0 0 24 24" fill="none">
            <path d="M9 18L15 12L9 6" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
          </svg>
        </button>
      </div>

      <!-- Indicadores -->
      <div class="carousel-indicators" *ngIf="ratings.length > 1">
        <button 
          *ngFor="let rating of ratings; let i = index"
          class="indicator"
          [class.active]="i === currentSlide"
          (click)="goToSlide(i)">
        </button>
      </div>
    </div>

    <!-- Estado vazio -->
    <div *ngIf="!isLoading && !error && ratings.length === 0" class="empty-state">
      <div class="empty-icon">⭐</div>
      <h3>Seja o primeiro a avaliar!</h3>
      <p>Ainda não temos avaliações, mas estamos ansiosos para conhecer sua experiência.</p>
    </div>
  </div>
</section>
