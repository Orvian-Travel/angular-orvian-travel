<!-- FormulÃ¡rio de AvaliaÃ§Ã£o -->
<div class="rating-form-container">
  <div class="rating-form-header">
    <h3 class="form-title">
      {{ existingRating ? 'Editar AvaliaÃ§Ã£o' : 'Avaliar ExperiÃªncia' }}
    </h3>
    <p class="form-subtitle">
      Compartilhe sua experiÃªncia e ajude outros viajantes
    </p>
  </div>

  <form [formGroup]="ratingForm" (ngSubmit)="onSubmit()" class="rating-form">
    
    <!-- SeÃ§Ã£o de Estrelas -->
    <div class="form-group">
      <label class="form-label">Sua nota *</label>
      <div class="stars-container">
        <button
          type="button"
          *ngFor="let star of [1,2,3,4,5]"
          class="star-button"
          [class]="getStarClass(star)"
          (click)="setRating(star)"
          (mouseenter)="setHoverRating(star)"
          (mouseleave)="clearHoverRating()"
          [attr.aria-label]="'Dar ' + star + ' estrela' + (star > 1 ? 's' : '')">
          â˜…
        </button>
      </div>
      <div class="rating-text" *ngIf="selectedRating > 0">
        <span [ngSwitch]="selectedRating">
          <span *ngSwitchCase="1">ğŸ˜ Muito ruim</span>
          <span *ngSwitchCase="2">ğŸ˜ Ruim</span>
          <span *ngSwitchCase="3">ğŸ™‚ Regular</span>
          <span *ngSwitchCase="4">ğŸ˜Š Bom</span>
          <span *ngSwitchCase="5">ğŸ˜ Excelente</span>
        </span>
      </div>
      <div class="error-message" *ngIf="hasFieldError('rate')">
        {{ getFieldError('rate') }}
      </div>
    </div>

    <!-- SeÃ§Ã£o de ComentÃ¡rio -->
    <div class="form-group">
      <label for="comment" class="form-label">Seu comentÃ¡rio *</label>
      <textarea
        id="comment"
        formControlName="comment"
        class="form-textarea"
        [class.error]="hasFieldError('comment')"
        placeholder="Conte-nos sobre sua experiÃªncia... O que mais gostou? O que poderia melhorar?"
        rows="5">
      </textarea>
      <div class="textarea-footer">
        <div class="char-counter" [class.warning]="getRemainingChars() < 50">
          {{ getRemainingChars() }} caracteres restantes
        </div>
      </div>
      <div class="error-message" *ngIf="hasFieldError('comment')">
        {{ getFieldError('comment') }}
      </div>
    </div>

    <!-- Mensagem de Erro Geral -->
    <div class="submit-error" *ngIf="submitError">
      <div class="error-icon">âš ï¸</div>
      <div class="error-text">{{ submitError }}</div>
    </div>

    <!-- BotÃµes de AÃ§Ã£o -->
    <div class="form-actions">
      <button
        type="button"
        class="btn btn-secondary"
        (click)="onCancel()"
        [disabled]="isSubmitting">
        Cancelar
      </button>
      
      <button
        type="submit"
        class="btn btn-primary"
        [disabled]="ratingForm.invalid || isSubmitting">
        <span *ngIf="isSubmitting" class="loading-spinner"></span>
        {{ isSubmitting ? 'Salvando...' : (existingRating ? 'Atualizar' : 'Enviar AvaliaÃ§Ã£o') }}
      </button>
    </div>

  </form>
</div>
